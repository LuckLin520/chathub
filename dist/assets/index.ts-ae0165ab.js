import{B as a}from"./browser-polyfill-5e752e65.js";import{p as o,q as u,A as p}from"./user-config-09eb902a.js";const d={}.VITE_PLAUSIBLE_API_HOST||"https://plausible.io";async function h(t,n){await o(`${d}/api/event`,{method:"POST",body:{domain:"chathub.gg",name:t,url:location.href,props:n},mode:"no-cors"})}async function m(){const{source:t}=await o("https://chathub.gg/api/user/source",{credentials:"include"});h("install",{source:t,language:navigator.language})}async function r(){const t=await a.tabs.query({}),n=a.runtime.getURL("app.html"),e=t.find(l=>{var i;return(i=l.url)==null?void 0:i.startsWith(n)});if(e){await a.tabs.update(e.id,{active:!0});return}const{startupPage:s}=await u(),c=s===p?"":`#/chat/${s}`;await a.tabs.create({url:`app.html${c}`})}a.action.onClicked.addListener(()=>{r()});a.runtime.onInstalled.addListener(t=>{t.reason==="install"&&(a.tabs.create({url:"app.html#/setting"}),m())});a.commands.onCommand.addListener(async t=>{t==="open-app"&&r()});
